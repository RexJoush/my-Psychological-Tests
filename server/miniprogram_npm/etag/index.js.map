{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["/*!\r\n * etag\r\n * Copyright(c) 2014-2016 Douglas Christopher Wilson\r\n * MIT Licensed\r\n */\r\n\r\n\r\n\r\n/**\r\n * Module exports.\r\n * @public\r\n */\r\n\r\nmodule.exports = etag\r\n\r\n/**\r\n * Module dependencies.\r\n * @private\r\n */\r\n\r\nvar crypto = require('crypto')\r\nvar Stats = require('fs').Stats\r\n\r\n/**\r\n * Module variables.\r\n * @private\r\n */\r\n\r\nvar toString = Object.prototype.toString\r\n\r\n/**\r\n * Generate an entity tag.\r\n *\r\n * @param {Buffer|string} entity\r\n * @return {string}\r\n * @private\r\n */\r\n\r\nfunction entitytag (entity) {\r\n  if (entity.length === 0) {\r\n    // fast-path empty\r\n    return '\"0-2jmj7l5rSw0yVb/vlWAYkK/YBwk\"'\r\n  }\r\n\r\n  // compute hash of entity\r\n  var hash = crypto\r\n    .createHash('sha1')\r\n    .update(entity, 'utf8')\r\n    .digest('base64')\r\n    .substring(0, 27)\r\n\r\n  // compute length of entity\r\n  var len = typeof entity === 'string'\r\n    ? Buffer.byteLength(entity, 'utf8')\r\n    : entity.length\r\n\r\n  return '\"' + len.toString(16) + '-' + hash + '\"'\r\n}\r\n\r\n/**\r\n * Create a simple ETag.\r\n *\r\n * @param {string|Buffer|Stats} entity\r\n * @param {object} [options]\r\n * @param {boolean} [options.weak]\r\n * @return {String}\r\n * @public\r\n */\r\n\r\nfunction etag (entity, options) {\r\n  if (entity == null) {\r\n    throw new TypeError('argument entity is required')\r\n  }\r\n\r\n  // support fs.Stats object\r\n  var isStats = isstats(entity)\r\n  var weak = options && typeof options.weak === 'boolean'\r\n    ? options.weak\r\n    : isStats\r\n\r\n  // validate argument\r\n  if (!isStats && typeof entity !== 'string' && !Buffer.isBuffer(entity)) {\r\n    throw new TypeError('argument entity must be string, Buffer, or fs.Stats')\r\n  }\r\n\r\n  // generate entity tag\r\n  var tag = isStats\r\n    ? stattag(entity)\r\n    : entitytag(entity)\r\n\r\n  return weak\r\n    ? 'W/' + tag\r\n    : tag\r\n}\r\n\r\n/**\r\n * Determine if object is a Stats object.\r\n *\r\n * @param {object} obj\r\n * @return {boolean}\r\n * @api private\r\n */\r\n\r\nfunction isstats (obj) {\r\n  // genuine fs.Stats\r\n  if (typeof Stats === 'function' && obj instanceof Stats) {\r\n    return true\r\n  }\r\n\r\n  // quack quack\r\n  return obj && typeof obj === 'object' &&\r\n    'ctime' in obj && toString.call(obj.ctime) === '[object Date]' &&\r\n    'mtime' in obj && toString.call(obj.mtime) === '[object Date]' &&\r\n    'ino' in obj && typeof obj.ino === 'number' &&\r\n    'size' in obj && typeof obj.size === 'number'\r\n}\r\n\r\n/**\r\n * Generate a tag for a stat.\r\n *\r\n * @param {object} stat\r\n * @return {string}\r\n * @private\r\n */\r\n\r\nfunction stattag (stat) {\r\n  var mtime = stat.mtime.getTime().toString(16)\r\n  var size = stat.size.toString(16)\r\n\r\n  return '\"' + size + '-' + mtime + '\"'\r\n}\r\n"]}